<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Paths Forward: AI, Humanity, and the Next Era of Education</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        /* Loomis Chaffee Brand Colors */
        :root {
            --lc-red: #98252b;
            --lc-gray: #323e47;
            --cupola: #5CB8B7;
            --cupola-light: #A0D2D1; /* 60% version */
            --river: #4E738A;
            --river-light: #92A6B5; /* 60% version */
            --meadow: #FFDD7F;
            --meadow-light: #FFE8B0; /* 60% version */
            --brick: #C25131;
            --brick-light: #E1947D; /* 60% version */
            --accent-red: #FC5A5C;
            --pelican: #d1d5d8; /* 90% pelican color for badges */
        }

        body {
            font-family: 'Proxima Nova', Arial, sans-serif;
            color: var(--lc-gray);
            background-color: #f9f9f9;
        }

        h1, h2, h3, h4, h5 {
            font-family: 'Financier Display', serif;
        }

        .lc-header {
            background-color: var(--lc-red);
            color: white;
            padding: 2rem 0;
        }

        .header-red {
            color: var(--lc-red);
        }

        .session-card {
            margin-bottom: 1.5rem;
            border-radius: 4px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: opacity 0.3s ease-in-out; /* Add transition for smooth hide/show */
            background-color: white; /* Ensure card background is white */
        }

        .tag {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .strand-ai-classroom {
            background-color: var(--cupola);
            color: white;
        }

        .strand-human-centered {
            background-color: var(--river);
            color: white;
        }

        /* Type Indicator Badges - Match filter button colors */
        .badge.type-workshop { 
            background-color: var(--lc-red) !important; 
            color: white !important;
        }
        .badge.type-presentation { 
            background-color: var(--meadow) !important; 
            color: var(--lc-gray) !important;
        }
        .badge.type-discussion { 
            background-color: var(--brick) !important; 
            color: white !important;
        }

        /* Type Indicator Borders */
        .type-workshop .card-body { border-left: 5px solid var(--lc-red); padding-left: 1rem; }
        .type-presentation .card-body { border-left: 5px solid var(--meadow); padding-left: 1rem; }
        .type-discussion .card-body { border-left: 5px solid var(--brick); padding-left: 1rem; }


        .filter-group {
            background-color: white;
            padding: 1.5rem;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            margin-bottom: 1.5rem;
            position: sticky; /* Make filters stick */
            top: 20px;       /* Adjust top offset as needed */
        }

        .filter-title {
            color: var(--lc-red);
            margin-bottom: 1rem;
            font-weight: 500;
        }

        /* Updated filter button styles for multi-select */
        .btn-filter {
            color: var(--lc-gray);
            border: 1px solid #ddd;
            transition: all 0.2s;
            margin-bottom: 0.5rem;
            text-align: left;
            padding: 0.5rem 0.75rem;
            opacity: 0.7; /* Start with slightly faded look */
        }

        .btn-filter:hover {
            opacity: 0.9;
        }

        .btn-filter.active {
            opacity: 1;
            font-weight: 500;
            transform: scale(1.02);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* Filter button colors - lighter when not selected */
        .btn-strand-all { background-color: #f0f0f0; }
        .btn-strand-all.active { background-color: var(--lc-gray); color: white; }

        .btn-strand-1 { background-color: var(--cupola-light); }
        .btn-strand-1.active { background-color: var(--cupola); color: white; }

        .btn-strand-2 { background-color: var(--river-light); }
        .btn-strand-2.active { background-color: var(--river); color: white; }

        .btn-type-all { background-color: #f0f0f0; }
        .btn-type-all.active { background-color: var(--lc-gray); color: white; }

        .btn-type-workshop { background-color: #C77C77; /* LC Red 60% */ }
        .btn-type-workshop.active { background-color: var(--lc-red); color: white; }

        .btn-type-presentation { background-color: var(--meadow-light); }
        .btn-type-presentation.active { background-color: var(--meadow); color: var(--lc-gray); }

        .btn-type-discussion { background-color: var(--brick-light); }
        .btn-type-discussion.active { background-color: var(--brick); color: white; }

        footer {
            background-color: var(--lc-gray);
            color: white;
            padding: 2rem 0;
            margin-top: 2rem;
        }

        .hidden {
            display: none !important;
        }

        /* Updated session description styles */
        .session-description {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }

        .session-description.show {
            max-height: 1000px; /* Large enough to show all content */
            margin-top: 15px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 5px;
            border-left: 3px solid var(--lc-red);
            transition: max-height 0.5s ease-in;
        }

        .session-badge {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        /* Session details styles - Updated for better readability */
        .session-details {
            margin-top: 8px;
            margin-bottom: 12px;
        }
        
        .session-details .badge {
            font-weight: normal;
            font-size: 0.85rem;
            padding: 6px 10px;
            background-color: var(--pelican) !important; /* Using pelican color */
            color: var(--lc-gray) !important;
            border: 1px solid #ddd;
        }
        
        .session-details .badge i {
            margin-right: 4px;
        }
        
        /* Loading indicator styles */
        #loading {
            text-align: center;
            padding: 20px;
            font-size: 1.2rem;
            color: var(--lc-red);
        }
        
        .spinner-border {
            width: 3rem;
            height: 3rem;
            margin-bottom: 1rem;
        }
        
        /* For expanded text functionality */
        .card-text-preview.collapsed {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <header class="lc-header">
        <div class="container">
            <div class="col-12 text-left">
                <h1>New Paths Forward</h1>
                <h2>AI, Humanity, and the Next Era of Education</h2>
            </div>
        </div>
    </header>

    <div class="container py-5">
        <div class="row">
            <div class="col-lg-3">
                <div class="filter-group-wrapper" style="position: sticky; top: 20px;">
                    <div class="filter-group">
                        <h4 class="filter-title">Filter by Strand</h4>
                        <div class="d-grid gap-1" id="strand-filters"> 
                            <button class="btn btn-filter btn-strand-all active" data-filter="all" onclick="toggleFilter('strand', 'all', this)">All Strands</button>
                            <button class="btn btn-filter btn-strand-1" data-filter="strand1" onclick="toggleFilter('strand', 'strand1', this)">Strand 1: AI in the Classroom</button>
                            <button class="btn btn-filter btn-strand-2" data-filter="strand2" onclick="toggleFilter('strand', 'strand2', this)">Strand 2: Human-Centered Innovation</button>
                        </div>
                    </div>

                    <div class="filter-group">
                        <h4 class="filter-title">Filter by Type</h4>
                        <div class="d-grid gap-1" id="type-filters"> 
                            <button class="btn btn-filter btn-type-all active" data-filter="all" onclick="toggleFilter('type', 'all', this)">All Types</button>
                            <button class="btn btn-filter btn-type-workshop" data-filter="type-workshop" onclick="toggleFilter('type', 'type-workshop', this)">Workshop</button>
                            <button class="btn btn-filter btn-type-presentation" data-filter="type-presentation" onclick="toggleFilter('type', 'type-presentation', this)">Presentation and Q&A</button>
                            <button class="btn btn-filter btn-type-discussion" data-filter="type-discussion" onclick="toggleFilter('type', 'type-discussion', this)">Facilitated Discussion</button>
                        </div>
                    </div>

                    <div class="filter-group">
                        <h4 class="filter-title">Search</h4>
                        <div class="input-group mb-3">
                            <input type="text" id="search-input" class="form-control" placeholder="Search sessions...">
                            <button class="btn btn-outline-secondary btn-type-all" type="button" onclick="applyFilters()">Search</button> 
                        </div>
                        <button class="btn btn-outline-secondary w-100 btn-type-all" onclick="resetAllFilters()">Clear All Filters</button>
                    </div>
                </div> 
            </div>

            <div class="col-lg-9">
                <h2 class="mb-4 header-red">Conference Sessions</h2>
                <div id="sessions-container">
                    <!-- Loading indicator -->
                    <div id="loading">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p>Loading session data...</p>
                    </div>
                    
                    <!-- Sessions will be dynamically inserted here -->
                    
                    <div id="no-results" class="alert alert-warning hidden">
                        No sessions match your criteria. Please adjust your filters or search term.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-8">
                    <h4>Loomis Chaffee</h4>
                    <p>4 Batchelder Road, Windsor, CT 06095</p>
                </div>
                <div class="col-md-4 text-md-end">
                    <p>&copy; 2025 Loomis Chaffee School</p> 
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const sessionsContainer = document.getElementById('sessions-container');
            const loadingElement = document.getElementById('loading');
            const noResultsDiv = document.getElementById('no-results');
            const searchInput = document.getElementById('search-input');
            
            // Track active filters
            const activeFilters = {
                strand: ['all'],
                type: ['all']
            };
            
            // Function to create a session card from session data
            function createSessionCard(session, index) {
                // Determine strand class and tag text
                const strandClass = session.strand === "strand1" ? "strand-ai-classroom" : "strand-human-centered";
                
                // Create the HTML for the session card with expanded text functionality
                const cardHtml = `
                    <div class="card session-card mb-4 ${session.type} ${session.strand}">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <span class="tag ${strandClass}">${session.strandName}</span>
                            <div class="session-badge">
                                <span class="badge ${session.type}">${session.typeName}</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">${session.title}</h5>
                            <h6 class="card-subtitle mb-2 text-muted">${session.presenter}</h6>
                            <div class="session-details mb-2">
                                <span class="badge bg-secondary me-2"><i class="bi bi-clock"></i> Time: ${session.time || 'TBD'}</span>
                                <span class="badge bg-secondary"><i class="bi bi-geo-alt"></i> Location: ${session.location || 'TBD'}</span>
                            </div>
                            
                            <!-- For expanding text, we keep it all in one element -->
                            <p class="card-text card-text-preview collapsed">${session.preview}</p>
                            
                            <button class="btn btn-sm btn-outline-secondary toggle-description" 
                                   onclick="toggleDescription(event, 'preview${index}', 'desc${index}')">Read More</button>
                            
                            <div id="desc${index}" class="session-description">
                                <!-- Additional details shown when expanded -->
                                <p><strong>Presenter:</strong> ${session.presenter}</p>
                                <p><strong>Email:</strong> ${session.email}</p>
                                <p><strong>Time:</strong> ${session.time || 'TBD'}</p>
                                <p><strong>Location:</strong> ${session.location || 'TBD'}</p>
                                ${session.description ? `<div class="mt-3"><strong>Additional Information:</strong><br>${session.description}</div>` : ''}
                            </div>
                        </div>
                    </div>
                `;
                
                return cardHtml;
            }
            
            // Function to load session data from JSON file
            async function loadSessionData() {
                try {
                    const response = await fetch('sessions.json');
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const sessionData = await response.json();
                    
                    // Remove loading indicator
                    if (loadingElement) {
                        loadingElement.remove();
                    }
                    
                    // Create and append session cards
                    sessionData.forEach((session, index) => {
                        const sessionCard = createSessionCard(session, index);
                        // Insert the HTML before the no-results div
                        noResultsDiv.insertAdjacentHTML('beforebegin', sessionCard);
                    });
                    
                    // After loading data, apply initial filters if needed
                    applyFilters();
                    
                } catch (error) {
                    console.error('Error loading session data:', error);
                    loadingElement.innerHTML = `
                        <div class="alert alert-danger">
                            Error loading session data. Please try refreshing the page.
                        </div>
                    `;
                }
            }
            
            // Call function to load session data
            loadSessionData();
            
            // --- Updated function to toggle session descriptions ---
            window.toggleDescription = function(event, previewId, descId) {
                event.preventDefault();
                const preview = document.querySelector(`.card-text-preview`);
                const desc = document.getElementById(descId);
                const button = event.currentTarget;

                if (preview && desc) {
                    if (desc.classList.contains('show')) {
                        // Collapse
                        preview.classList.add('collapsed');
                        desc.classList.remove('show');
                        button.textContent = 'Read More';
                    } else {
                        // Expand
                        preview.classList.remove('collapsed');
                        desc.classList.add('show');
                        button.textContent = 'Show Less';
                    }
                }
            }

            // --- Updated function for multi-select filtering ---
            window.toggleFilter = function(group, value, element) {
                // Special handling for 'all' filter
                if (value === 'all') {
                    // If 'all' is clicked and not already active, make it the only active filter
                    if (!element.classList.contains('active')) {
                        document.querySelectorAll(`#${group}-filters .btn-filter`).forEach(button => {
                            button.classList.remove('active');
                        });
                        element.classList.add('active');
                        activeFilters[group] = ['all'];
                    }
                } else {
                    // If a specific filter is clicked
                    const allButton = document.querySelector(`#${group}-filters [data-filter="all"]`);
                    
                    // Remove 'all' from active filters
                    if (allButton.classList.contains('active')) {
                        allButton.classList.remove('active');
                        activeFilters[group] = [];
                    }
                    
                    // Toggle this specific filter
                    if (element.classList.contains('active')) {
                        // Remove this filter
                        element.classList.remove('active');
                        activeFilters[group] = activeFilters[group].filter(f => f !== value);
                        
                        // If no filters are active, activate 'all'
                        if (activeFilters[group].length === 0) {
                            allButton.classList.add('active');
                            activeFilters[group] = ['all'];
                        }
                    } else {
                        // Add this filter
                        element.classList.add('active');
                        activeFilters[group].push(value);
                    }
                }
                
                // Apply all filters after changing state
                applyFilters();
            }

            // --- Updated function to apply multi-select filters ---
            window.applyFilters = function() {
                const searchTerm = searchInput.value.toLowerCase().trim();
                let visibleCount = 0;

                // Get all session cards
                const allSessionCards = sessionsContainer.querySelectorAll('.session-card');

                allSessionCards.forEach(card => {
                    const cardStrand = Array.from(card.classList).find(cls => cls.startsWith('strand'));
                    const cardType = Array.from(card.classList).find(cls => cls.startsWith('type-'));
                    let showCard = true;

                    // Check if we should apply strand filtering
                    if (!activeFilters.strand.includes('all')) {
                        showCard = activeFilters.strand.includes(cardStrand);
                    }

                    // Check if we should apply type filtering
                    if (showCard && !activeFilters.type.includes('all')) {
                        showCard = activeFilters.type.includes(cardType);
                    }

                    // Check Search Term
                    if (showCard && searchTerm !== '') {
                        // Include title, subtitle, preview text, and full description in search
                        const title = card.querySelector('.card-title')?.textContent.toLowerCase() || '';
                        const subtitle = card.querySelector('.card-subtitle')?.textContent.toLowerCase() || '';
                        const preview = card.querySelector('.card-text-preview')?.textContent.toLowerCase() || '';
                        const fullDesc = card.querySelector('.session-description')?.textContent.toLowerCase() || '';
                        const combinedText = `${title} ${subtitle} ${preview} ${fullDesc}`;

                        if (!combinedText.includes(searchTerm)) {
                            showCard = false;
                        }
                    }

                    // Show or Hide Card
                    if (showCard) {
                        card.classList.remove('hidden');
                        visibleCount++;
                    } else {
                        card.classList.add('hidden');
                        // Collapse any expanded descriptions
                        const desc = card.querySelector('.session-description');
                        const preview = card.querySelector('.card-text-preview');
                        const button = card.querySelector('.toggle-description');
                        
                        if (desc && desc.classList.contains('show')) {
                            desc.classList.remove('show');
                            if (preview) preview.classList.add('collapsed');
                            if (button) button.textContent = 'Read More';
                        }
                    }
                });

                // Show/Hide "No Results" Message
                if (visibleCount === 0) {
                    noResultsDiv.classList.remove('hidden');
                } else {
                    noResultsDiv.classList.add('hidden');
                }
            }

            // --- Updated function to reset all filters ---
            window.resetAllFilters = function() {
                // Reset active filters state
                activeFilters.strand = ['all'];
                activeFilters.type = ['all'];
                
                // Update UI to match state
                document.querySelectorAll('.btn-filter').forEach(button => {
                    button.classList.remove('active');
                });
                
                document.querySelector('#strand-filters [data-filter="all"]').classList.add('active');
                document.querySelector('#type-filters [data-filter="all"]').classList.add('active');

                // Clear search input
                searchInput.value = '';

                // Apply filters
                applyFilters();
            }

            // --- Event Listeners ---
            // Search on input change (live search)
            searchInput.addEventListener('input', applyFilters);

            // Search on Enter key press in the search input
            searchInput.addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    event.preventDefault(); // Prevent potential form submission
                    applyFilters();
                }
            });
        }); // End DOMContentLoaded
    </script>
</body>
</html>
